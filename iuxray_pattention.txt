Namespace(amsgrad=True, ann_path='data/iu_xray/annotation.json', batch_size=40, beam_size=3, block_trigrams=1, bos_idx=0, d_ff=512, d_model=512, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=100, gamma=0.1, group_size=1, image_dir='data/iu_xray/images/', logit_layers=1, lr_ed=0.0001, lr_scheduler='StepLR', lr_ve=5e-05, max_seq_length=60, model='r2genaugv3abrm', monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, num_heads=8, num_layers=12, num_workers=2, optim='Adam', output_logsoftmax=1, pad_idx=0, record_dir='records/', resume=None, rm_d_model=512, rm_num_heads=8, rm_num_slots=3, sample_method='beam_search', sample_n=1, save_dir='results/iuxray_pattention', save_period=1, seed=9223, step_size=50, temperature=1.0, threshold=3, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05)
time for training one epoch 00:01:01
self._sample_beam(fc_feats, att_feats, att_masks, opt) torch.Size([40, 4096]) torch.Size([40, 98, 2048])
self._sample_beam(fc_feats, att_feats, att_masks, opt) torch.Size([40, 4096]) torch.Size([40, 98, 2048])

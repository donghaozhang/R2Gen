Namespace(amsgrad=True, ann_path='../mimic_cxr_256/annotation.json', batch_size=600, beam_size=3, block_trigrams=1, bos_idx=0, d_ff=512, d_model=512, d_vf=2048, dataset_name='mimic_cxr', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=30, gamma=0.8, group_size=1, image_dir='../mimic_cxr_256/images/', logit_layers=1, lr_ed=0.0001, lr_scheduler='StepLR', lr_ve=0.0005, max_seq_length=100, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=8, num_heads=8, num_layers=3, num_workers=2, optim='Adam', output_logsoftmax=1, pad_idx=0, record_dir='records/', resume=None, rm_d_model=512, rm_num_heads=8, rm_num_slots=3, sample_method='beam_search', sample_n=1, save_dir='results/mimic_cxr', save_period=1, seed=456789, step_size=1, temperature=1.0, threshold=10, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05)
time for training one epoch 00:49:34
time for validating one epoch 00:03:58
time for testing one epoch 00:06:32
	epoch          : 1
	train_loss     : 3.3241529121863103
	val_BLEU_1     : 0.2658699449556663
	val_BLEU_2     : 0.17872248762328705
	val_BLEU_3     : 0.12803232385012678
	val_BLEU_4     : 0.0954090246708976
	val_METEOR     : 0.12195734670582363
	val_ROUGE_L    : 0.30690159798161293
	test_BLEU_1    : 0.17234606225285595
	test_BLEU_2    : 0.11058775580174553
	test_BLEU_3    : 0.07669602501723835
	test_BLEU_4    : 0.05573623734022544
	test_METEOR    : 0.09363527195213138
	test_ROUGE_L   : 0.25118275235905063
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:48:35
time for validating one epoch 00:03:48
time for testing one epoch 00:06:26
	epoch          : 2
	train_loss     : 2.103332615795389
	val_BLEU_1     : 0.27859135395093526
	val_BLEU_2     : 0.18421435276320983
	val_BLEU_3     : 0.13029364336486496
	val_BLEU_4     : 0.09714773547877752
	val_METEOR     : 0.1224061881074897
	val_ROUGE_L    : 0.3058479949803323
	test_BLEU_1    : 0.20881963543550522
	test_BLEU_2    : 0.12935800999728478
	test_BLEU_3    : 0.0869807676300414
	test_BLEU_4    : 0.06223337140697111
	test_METEOR    : 0.09670956717114584
	test_ROUGE_L   : 0.2500485848016893
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:47:55
time for validating one epoch 00:03:47
time for testing one epoch 00:06:24
	epoch          : 3
	train_loss     : 1.8921480020590589
	val_BLEU_1     : 0.30421688160857857
	val_BLEU_2     : 0.2011927625940239
	val_BLEU_3     : 0.14204316853976123
	val_BLEU_4     : 0.10577551928743444
	val_METEOR     : 0.13281144746395948
	val_ROUGE_L    : 0.3139757730477078
	test_BLEU_1    : 0.24945606678473015
	test_BLEU_2    : 0.1554388825352141
	test_BLEU_3    : 0.10468278108525603
	test_BLEU_4    : 0.07487666941423937
	test_METEOR    : 0.11045236897240442
	test_ROUGE_L   : 0.26262748231539834
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:49:10
time for validating one epoch 00:03:54
time for testing one epoch 00:06:24
	epoch          : 4
	train_loss     : 1.7907817878026877
	val_BLEU_1     : 0.2936775822098207
	val_BLEU_2     : 0.19412303665981817
	val_BLEU_3     : 0.1373269766213314
	val_BLEU_4     : 0.10289177844408148
	val_METEOR     : 0.13056237696075168
	val_ROUGE_L    : 0.31267622170601417
	test_BLEU_1    : 0.24314143802338228
	test_BLEU_2    : 0.15101126025212094
	test_BLEU_3    : 0.10121774755585257
	test_BLEU_4    : 0.07204480449535569
	test_METEOR    : 0.1079648899798368
	test_ROUGE_L   : 0.26105167404465035
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:47:22
time for validating one epoch 00:03:46
time for testing one epoch 00:06:26
	epoch          : 5
	train_loss     : 1.7300647204428647
	val_BLEU_1     : 0.2996029105895674
	val_BLEU_2     : 0.19818344612196348
	val_BLEU_3     : 0.1404124174912219
	val_BLEU_4     : 0.10545921826562674
	val_METEOR     : 0.13391155158506354
	val_ROUGE_L    : 0.3146178742795583
	test_BLEU_1    : 0.2483191480376877
	test_BLEU_2    : 0.15331966627669982
	test_BLEU_3    : 0.1021875646091532
	test_BLEU_4    : 0.07276308597345067
	test_METEOR    : 0.1112780814260096
	test_ROUGE_L   : 0.2602304291156198
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:45:58
time for validating one epoch 00:03:48
time for testing one epoch 00:06:24
	epoch          : 6
	train_loss     : 1.6889654556206897
	val_BLEU_1     : 0.3241954651396641
	val_BLEU_2     : 0.21327589569376593
	val_BLEU_3     : 0.1501911478431025
	val_BLEU_4     : 0.11194717850509611
	val_METEOR     : 0.138178645173497
	val_ROUGE_L    : 0.31517951182509335
	test_BLEU_1    : 0.28041896607684097
	test_BLEU_2    : 0.17283544719283853
	test_BLEU_3    : 0.1154837466186245
	test_BLEU_4    : 0.0823627300730699
	test_METEOR    : 0.11842520206391795
	test_ROUGE_L   : 0.2655857166109654
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:46:11
time for validating one epoch 00:03:45
time for testing one epoch 00:06:23
	epoch          : 7
	train_loss     : 1.660181305841007
	val_BLEU_1     : 0.33498183962386086
	val_BLEU_2     : 0.22055013331291323
	val_BLEU_3     : 0.1550317484424942
	val_BLEU_4     : 0.11511554625958825
	val_METEOR     : 0.1402349690087118
	val_ROUGE_L    : 0.31578313693157944
	test_BLEU_1    : 0.2885209959696357
	test_BLEU_2    : 0.1791887921858309
	test_BLEU_3    : 0.12015286619549072
	test_BLEU_4    : 0.08578165038676933
	test_METEOR    : 0.11985151587868632
	test_ROUGE_L   : 0.26734464359909416
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:45:45
time for validating one epoch 00:03:46
time for testing one epoch 00:06:23
	epoch          : 8
	train_loss     : 1.6390513292456095
	val_BLEU_1     : 0.3263256952176939
	val_BLEU_2     : 0.21307559907769363
	val_BLEU_3     : 0.1485684280249167
	val_BLEU_4     : 0.10951815926544164
	val_METEOR     : 0.13793848796248445
	val_ROUGE_L    : 0.31127931138308157
	test_BLEU_1    : 0.27738275595682454
	test_BLEU_2    : 0.1715736968191484
	test_BLEU_3    : 0.11489590578904799
	test_BLEU_4    : 0.08184177199681196
	test_METEOR    : 0.11858333298725829
	test_ROUGE_L   : 0.2646388098050977
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:45:55
time for validating one epoch 00:03:46
time for testing one epoch 00:06:23
	epoch          : 9
	train_loss     : 1.6229975719367509
	val_BLEU_1     : 0.34249278545161466
	val_BLEU_2     : 0.22486290988559396
	val_BLEU_3     : 0.15739538945330805
	val_BLEU_4     : 0.11626008584789865
	val_METEOR     : 0.14247022333050194
	val_ROUGE_L    : 0.317084949311317
	test_BLEU_1    : 0.2887976328234018
	test_BLEU_2    : 0.1792567185518492
	test_BLEU_3    : 0.12002742160922673
	test_BLEU_4    : 0.08539713492481436
	test_METEOR    : 0.12161464974191878
	test_ROUGE_L   : 0.2677119921742786
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:47:08
time for validating one epoch 00:03:45
time for testing one epoch 00:06:22
	epoch          : 10
	train_loss     : 1.6104476995172754
	val_BLEU_1     : 0.3423235677166894
	val_BLEU_2     : 0.2241274589597532
	val_BLEU_3     : 0.15628823268760084
	val_BLEU_4     : 0.11495516574300761
	val_METEOR     : 0.14179187393803275
	val_ROUGE_L    : 0.31487029762106095
	test_BLEU_1    : 0.2945733515464619
	test_BLEU_2    : 0.1831989798034982
	test_BLEU_3    : 0.12263696380661701
	test_BLEU_4    : 0.08716609197907109
	test_METEOR    : 0.12301551981411021
	test_ROUGE_L   : 0.2691068132496844
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:46:40
time for validating one epoch 00:03:47
time for testing one epoch 00:06:23
	epoch          : 11
	train_loss     : 1.6010043679085453
	val_BLEU_1     : 0.341927787386129
	val_BLEU_2     : 0.22382177892380922
	val_BLEU_3     : 0.15620866515293927
	val_BLEU_4     : 0.1148703401688916
	val_METEOR     : 0.1415214196187767
	val_ROUGE_L    : 0.3138764452372642
	test_BLEU_1    : 0.2934321748026528
	test_BLEU_2    : 0.18208043178439898
	test_BLEU_3    : 0.1215210173890732
	test_BLEU_4    : 0.08606381275160298
	test_METEOR    : 0.12221581132104462
	test_ROUGE_L   : 0.2683937447602889
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:45:54
time for validating one epoch 00:03:46
time for testing one epoch 00:06:28
	epoch          : 12
	train_loss     : 1.5935959844990115
	val_BLEU_1     : 0.3377997027611011
	val_BLEU_2     : 0.22109731809657807
	val_BLEU_3     : 0.15431710467516743
	val_BLEU_4     : 0.11375479851172028
	val_METEOR     : 0.1409019454917406
	val_ROUGE_L    : 0.31432480688363085
	test_BLEU_1    : 0.2885661374397172
	test_BLEU_2    : 0.1787428489854235
	test_BLEU_3    : 0.11923351908275825
	test_BLEU_4    : 0.08463664994789541
	test_METEOR    : 0.12072299526222763
	test_ROUGE_L   : 0.26582845866992993
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:46:35
time for validating one epoch 00:03:44
time for testing one epoch 00:06:25
	epoch          : 13
	train_loss     : 1.587664669857616
	val_BLEU_1     : 0.3370229363962554
	val_BLEU_2     : 0.2215668794064879
	val_BLEU_3     : 0.1548747997854653
	val_BLEU_4     : 0.11404395353865372
	val_METEOR     : 0.14160967390451853
	val_ROUGE_L    : 0.3162886628195553
	test_BLEU_1    : 0.2914624194156922
	test_BLEU_2    : 0.1800777710924007
	test_BLEU_3    : 0.11949503796230239
	test_BLEU_4    : 0.0842174202189542
	test_METEOR    : 0.121725030259973
	test_ROUGE_L   : 0.2673757101681723
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:50:07
time for validating one epoch 00:03:46
time for testing one epoch 00:06:25
	epoch          : 14
	train_loss     : 1.5825282184951073
	val_BLEU_1     : 0.3507988447339517
	val_BLEU_2     : 0.22942396699511775
	val_BLEU_3     : 0.1602474714714683
	val_BLEU_4     : 0.1182809311324572
	val_METEOR     : 0.1446954016758401
	val_ROUGE_L    : 0.3162386651468536
	test_BLEU_1    : 0.3005243572158087
	test_BLEU_2    : 0.18597262055840683
	test_BLEU_3    : 0.12373351673555591
	test_BLEU_4    : 0.087317135520448
	test_METEOR    : 0.1240153635158194
	test_ROUGE_L   : 0.267795620237518
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:52:31
time for validating one epoch 00:03:47
time for testing one epoch 00:06:26
	epoch          : 15
	train_loss     : 1.5788881235418066
	val_BLEU_1     : 0.3482280170443197
	val_BLEU_2     : 0.22827555683112252
	val_BLEU_3     : 0.15918651781135804
	val_BLEU_4     : 0.11717561959242019
	val_METEOR     : 0.1429625633334734
	val_ROUGE_L    : 0.31509198802980937
	test_BLEU_1    : 0.29809893860248077
	test_BLEU_2    : 0.1837991017755591
	test_BLEU_3    : 0.12155200389310378
	test_BLEU_4    : 0.0852259377541509
	test_METEOR    : 0.12255573400475875
	test_ROUGE_L   : 0.2665527843495925
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:49:37
time for validating one epoch 00:03:46
time for testing one epoch 00:06:25
	epoch          : 16
	train_loss     : 1.5757988836385508
	val_BLEU_1     : 0.35627627099465753
	val_BLEU_2     : 0.2314523670040757
	val_BLEU_3     : 0.15982106440962837
	val_BLEU_4     : 0.11623210556479445
	val_METEOR     : 0.14360891133564455
	val_ROUGE_L    : 0.3112338902185021
	test_BLEU_1    : 0.2999902352416504
	test_BLEU_2    : 0.18477030932965383
	test_BLEU_3    : 0.1221681162767188
	test_BLEU_4    : 0.08562744573876192
	test_METEOR    : 0.12279458020038518
	test_ROUGE_L   : 0.26678168845816297
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:51:33
time for validating one epoch 00:03:47
time for testing one epoch 00:06:26
	epoch          : 17
	train_loss     : 1.5734909226936578
	val_BLEU_1     : 0.3463579368052494
	val_BLEU_2     : 0.22840402849200178
	val_BLEU_3     : 0.16068464546526712
	val_BLEU_4     : 0.11930314174845336
	val_METEOR     : 0.1439803907446532
	val_ROUGE_L    : 0.3176487654337187
	test_BLEU_1    : 0.2911411799150796
	test_BLEU_2    : 0.17946485483016897
	test_BLEU_3    : 0.11884184110757659
	test_BLEU_4    : 0.0835343710063089
	test_METEOR    : 0.1213253706791302
	test_ROUGE_L   : 0.26525844071700005
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
Saving current best: model_best.pth ...
time for training one epoch 00:50:56
time for validating one epoch 00:03:45
time for testing one epoch 00:06:26
	epoch          : 18
	train_loss     : 1.5717201280382882
	val_BLEU_1     : 0.34711339938131697
	val_BLEU_2     : 0.22872841718920395
	val_BLEU_3     : 0.16061382250074704
	val_BLEU_4     : 0.11892740673074384
	val_METEOR     : 0.1438416363942072
	val_ROUGE_L    : 0.3167787228692789
	test_BLEU_1    : 0.2912966946073022
	test_BLEU_2    : 0.17993128880336234
	test_BLEU_3    : 0.11938481242083716
	test_BLEU_4    : 0.08411108209312787
	test_METEOR    : 0.1214045519607168
	test_ROUGE_L   : 0.26528123535817355
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:50:31
time for validating one epoch 00:03:48
time for testing one epoch 00:06:28
	epoch          : 19
	train_loss     : 1.5699175535577587
	val_BLEU_1     : 0.3449704391846952
	val_BLEU_2     : 0.22563929756244275
	val_BLEU_3     : 0.15721483390285748
	val_BLEU_4     : 0.11538941215536004
	val_METEOR     : 0.14299683580707223
	val_ROUGE_L    : 0.3143360788001518
	test_BLEU_1    : 0.29460248877746387
	test_BLEU_2    : 0.18145031004276369
	test_BLEU_3    : 0.11983706677226433
	test_BLEU_4    : 0.08398502019623917
	test_METEOR    : 0.12205350002445303
	test_ROUGE_L   : 0.2656667648446809
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:51:10
time for validating one epoch 00:03:48
time for testing one epoch 00:06:27
	epoch          : 20
	train_loss     : 1.5687578294129498
	val_BLEU_1     : 0.34804848505484465
	val_BLEU_2     : 0.22836205272054264
	val_BLEU_3     : 0.1595122637154237
	val_BLEU_4     : 0.11750787752868863
	val_METEOR     : 0.14330629667909506
	val_ROUGE_L    : 0.31438848446782514
	test_BLEU_1    : 0.2960520254111954
	test_BLEU_2    : 0.18325635210572339
	test_BLEU_3    : 0.12171099352730466
	test_BLEU_4    : 0.08581122191315446
	test_METEOR    : 0.12250592562512616
	test_ROUGE_L   : 0.2660614845137909
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:52:19
time for validating one epoch 00:03:51
time for testing one epoch 00:06:29
	epoch          : 21
	train_loss     : 1.5676668536874045
	val_BLEU_1     : 0.3518312702759051
	val_BLEU_2     : 0.23088441873635165
	val_BLEU_3     : 0.1613704489835658
	val_BLEU_4     : 0.11892266090952626
	val_METEOR     : 0.14440951746260644
	val_ROUGE_L    : 0.31568989657998026
	test_BLEU_1    : 0.2973573616765339
	test_BLEU_2    : 0.18359378267274526
	test_BLEU_3    : 0.12166221141175866
	test_BLEU_4    : 0.08550174528872584
	test_METEOR    : 0.12273302862292776
	test_ROUGE_L   : 0.26603408951225055
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:52:31
time for validating one epoch 00:03:50
time for testing one epoch 00:06:29
	epoch          : 22
	train_loss     : 1.5668729781049542
	val_BLEU_1     : 0.3517366229681977
	val_BLEU_2     : 0.23017098207530606
	val_BLEU_3     : 0.16062669154640677
	val_BLEU_4     : 0.11836164304319625
	val_METEOR     : 0.14482590363843578
	val_ROUGE_L    : 0.3164617410651314
	test_BLEU_1    : 0.2979170535871538
	test_BLEU_2    : 0.18367913399807903
	test_BLEU_3    : 0.12156336243311021
	test_BLEU_4    : 0.08535306859293156
	test_METEOR    : 0.12299846321722889
	test_ROUGE_L   : 0.26658980549859423
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:51:07
time for validating one epoch 00:03:49
time for testing one epoch 00:06:28
	epoch          : 23
	train_loss     : 1.5663100525868678
	val_BLEU_1     : 0.3475592300210415
	val_BLEU_2     : 0.22743390329313112
	val_BLEU_3     : 0.1585817581916576
	val_BLEU_4     : 0.11678378203401436
	val_METEOR     : 0.14365714586290054
	val_ROUGE_L    : 0.31359392803680564
	test_BLEU_1    : 0.29310001324668433
	test_BLEU_2    : 0.18084137003441095
	test_BLEU_3    : 0.11980658319274558
	test_BLEU_4    : 0.08432059119707021
	test_METEOR    : 0.1218588484344069
	test_ROUGE_L   : 0.265053575102275
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...
time for training one epoch 00:52:19
time for validating one epoch 00:03:51
time for testing one epoch 00:06:28
	epoch          : 24
	train_loss     : 1.5654210079032762
	val_BLEU_1     : 0.3505113514549509
	val_BLEU_2     : 0.22971945178132308
	val_BLEU_3     : 0.16037630948251494
	val_BLEU_4     : 0.11815052085437099
	val_METEOR     : 0.14443819256923032
	val_ROUGE_L    : 0.31559348276619154
	test_BLEU_1    : 0.2967208601471065
	test_BLEU_2    : 0.1831566939536903
	test_BLEU_3    : 0.12121203577345704
	test_BLEU_4    : 0.08507158606426997
	test_METEOR    : 0.12233193786898854
	test_ROUGE_L   : 0.2656656379286144
Saving checkpoint: results/mimic_cxr/current_checkpoint.pth ...

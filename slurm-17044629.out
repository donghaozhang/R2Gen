Namespace(amsgrad=True, ann_path='../iu_xray/annotation.json', batch_size=16, beam_size=3, block_trigrams=1, bos_idx=0, d_ff=512, d_model=512, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=100, gamma=0.1, group_size=1, image_dir='../iu_xray/images/', logit_layers=1, lr_ed=0.0001, lr_scheduler='StepLR', lr_ve=5e-05, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=8, num_heads=8, num_layers=3, num_workers=2, optim='Adam', output_logsoftmax=1, pad_idx=0, record_dir='records/', resume=None, rm_d_model=512, rm_num_heads=8, rm_num_slots=3, sample_method='beam_search', sample_n=1, save_dir='results/iu_xray_debug', save_period=1, seed=9223, step_size=100, temperature=1.0, threshold=3, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05)
	epoch          : 1
	train_loss     : 3.797557601561913
	val_BLEU_1     : 0.29626777339323346
	val_BLEU_2     : 0.18965454520486522
	val_BLEU_3     : 0.13535399848120575
	val_BLEU_4     : 0.09999293494000035
	val_METEOR     : 0.11415943524178006
	val_ROUGE_L    : 0.33891346711329073
	test_BLEU_1    : 0.333478785457572
	test_BLEU_2    : 0.21674992357127032
	test_BLEU_3    : 0.15779353391715026
	test_BLEU_4    : 0.11846635868489527
	test_METEOR    : 0.12634182096956595
	test_ROUGE_L   : 0.35540318494139495
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
Saving current best: model_best.pth ...
	epoch          : 2
	train_loss     : 2.5670421847930323
	val_BLEU_1     : 0.1988625889127359
	val_BLEU_2     : 0.1180353903908086
	val_BLEU_3     : 0.0835544869652126
	val_BLEU_4     : 0.06400886298630389
	val_METEOR     : 0.1034722429799017
	val_ROUGE_L    : 0.29474007494202537
	test_BLEU_1    : 0.2414891728040812
	test_BLEU_2    : 0.14657508017251872
	test_BLEU_3    : 0.10545486468993152
	test_BLEU_4    : 0.08101704657824713
	test_METEOR    : 0.11945841070409312
	test_ROUGE_L   : 0.3121804906222145
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 3
	train_loss     : 2.1718013240740848
	val_BLEU_1     : 0.1988625889127359
	val_BLEU_2     : 0.1180353903908086
	val_BLEU_3     : 0.0835544869652126
	val_BLEU_4     : 0.06400886298630389
	val_METEOR     : 0.1034722429799017
	val_ROUGE_L    : 0.29474007494202537
	test_BLEU_1    : 0.2414891728040812
	test_BLEU_2    : 0.14657508017251872
	test_BLEU_3    : 0.10545486468993152
	test_BLEU_4    : 0.08101704657824713
	test_METEOR    : 0.11945841070409312
	test_ROUGE_L   : 0.3121804906222145
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 4
	train_loss     : 1.9365925156153165
	val_BLEU_1     : 0.1988625889127359
	val_BLEU_2     : 0.1180353903908086
	val_BLEU_3     : 0.0835544869652126
	val_BLEU_4     : 0.06400886298630389
	val_METEOR     : 0.1034722429799017
	val_ROUGE_L    : 0.29474007494202537
	test_BLEU_1    : 0.2414891728040812
	test_BLEU_2    : 0.14657508017251872
	test_BLEU_3    : 0.10545486468993152
	test_BLEU_4    : 0.08101704657824713
	test_METEOR    : 0.11945841070409312
	test_ROUGE_L   : 0.3121804906222145
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 5
	train_loss     : 1.774671181348654
	val_BLEU_1     : 0.1988625889127359
	val_BLEU_2     : 0.1180353903908086
	val_BLEU_3     : 0.0835544869652126
	val_BLEU_4     : 0.06400886298630389
	val_METEOR     : 0.1034722429799017
	val_ROUGE_L    : 0.29474007494202537
	test_BLEU_1    : 0.2414891728040812
	test_BLEU_2    : 0.14657508017251872
	test_BLEU_3    : 0.10545486468993152
	test_BLEU_4    : 0.08101704657824713
	test_METEOR    : 0.11945841070409312
	test_ROUGE_L   : 0.3121804906222145
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 6
	train_loss     : 1.640840117747967
	val_BLEU_1     : 0.2063922732930478
	val_BLEU_2     : 0.1223140975698409
	val_BLEU_3     : 0.08626685947320434
	val_BLEU_4     : 0.06587310126524061
	val_METEOR     : 0.10493987965227271
	val_ROUGE_L    : 0.2958979629336786
	test_BLEU_1    : 0.24610848363755977
	test_BLEU_2    : 0.1488747048367395
	test_BLEU_3    : 0.10677760226030565
	test_BLEU_4    : 0.0818132306511166
	test_METEOR    : 0.12022896197272828
	test_ROUGE_L   : 0.31207335406457976
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 7
	train_loss     : 1.5271701069978567
	val_BLEU_1     : 0.1988625889127359
	val_BLEU_2     : 0.1180353903908086
	val_BLEU_3     : 0.0835544869652126
	val_BLEU_4     : 0.06400886298630389
	val_METEOR     : 0.1034722429799017
	val_ROUGE_L    : 0.29474007494202537
	test_BLEU_1    : 0.2414891728040812
	test_BLEU_2    : 0.14657508017251872
	test_BLEU_3    : 0.10545486468993152
	test_BLEU_4    : 0.08101704657824713
	test_METEOR    : 0.11945841070409312
	test_ROUGE_L   : 0.3121804906222145
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 8
	train_loss     : 1.435913492166079
	val_BLEU_1     : 0.1988625889127359
	val_BLEU_2     : 0.1180353903908086
	val_BLEU_3     : 0.0835544869652126
	val_BLEU_4     : 0.06400886298630389
	val_METEOR     : 0.1034722429799017
	val_ROUGE_L    : 0.29474007494202537
	test_BLEU_1    : 0.2414891728040812
	test_BLEU_2    : 0.14657508017251872
	test_BLEU_3    : 0.10545486468993152
	test_BLEU_4    : 0.08101704657824713
	test_METEOR    : 0.11945841070409312
	test_ROUGE_L   : 0.3121804906222145
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 9
	train_loss     : 1.3488556742668152
	val_BLEU_1     : 0.1988625889127359
	val_BLEU_2     : 0.1180353903908086
	val_BLEU_3     : 0.0835544869652126
	val_BLEU_4     : 0.06400886298630389
	val_METEOR     : 0.1034722429799017
	val_ROUGE_L    : 0.29474007494202537
	test_BLEU_1    : 0.2414891728040812
	test_BLEU_2    : 0.14657508017251872
	test_BLEU_3    : 0.10545486468993152
	test_BLEU_4    : 0.08101704657824713
	test_METEOR    : 0.11945841070409312
	test_ROUGE_L   : 0.3121804906222145
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 10
	train_loss     : 1.2683586001396179
	val_BLEU_1     : 0.21579372623605608
	val_BLEU_2     : 0.12738746561434172
	val_BLEU_3     : 0.08913503799065359
	val_BLEU_4     : 0.06753191334415574
	val_METEOR     : 0.10804877423012843
	val_ROUGE_L    : 0.2958808554749409
	test_BLEU_1    : 0.2615517678392187
	test_BLEU_2    : 0.16092999808934325
	test_BLEU_3    : 0.11566294239726418
	test_BLEU_4    : 0.0886102720018079
	test_METEOR    : 0.1264330387618542
	test_ROUGE_L   : 0.3167386820642857
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 11
	train_loss     : 1.1885613386447613
	val_BLEU_1     : 0.35510817549050055
	val_BLEU_2     : 0.1993432562704494
	val_BLEU_3     : 0.13271892973750476
	val_BLEU_4     : 0.09612955713329246
	val_METEOR     : 0.1355138671420832
	val_ROUGE_L    : 0.3084834827159034
	test_BLEU_1    : 0.38829253831415617
	test_BLEU_2    : 0.231497057256551
	test_BLEU_3    : 0.16379028629544348
	test_BLEU_4    : 0.12452312724686802
	test_METEOR    : 0.1512087379915606
	test_ROUGE_L   : 0.3302081169909666
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 12
	train_loss     : 1.1183499253713167
	val_BLEU_1     : 0.4135144836667557
	val_BLEU_2     : 0.22493250105009419
	val_BLEU_3     : 0.14414718970230067
	val_BLEU_4     : 0.10012320521683657
	val_METEOR     : 0.15156299460133663
	val_ROUGE_L    : 0.30750093858649874
	test_BLEU_1    : 0.4335848483313701
	test_BLEU_2    : 0.2583951197827054
	test_BLEU_3    : 0.18216496863946927
	test_BLEU_4    : 0.13791846367835606
	test_METEOR    : 0.17438198508339084
	test_ROUGE_L   : 0.3395434880128929
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
Saving current best: model_best.pth ...
	epoch          : 13
	train_loss     : 1.0496102828245897
	val_BLEU_1     : 0.22414659396694547
	val_BLEU_2     : 0.13223576857824568
	val_BLEU_3     : 0.09250464182338893
	val_BLEU_4     : 0.06985312278351692
	val_METEOR     : 0.10982655018733649
	val_ROUGE_L    : 0.2973971743314356
	test_BLEU_1    : 0.27178529221383724
	test_BLEU_2    : 0.16580226349504254
	test_BLEU_3    : 0.11832368753518858
	test_BLEU_4    : 0.08970972373685955
	test_METEOR    : 0.12779760832690018
	test_ROUGE_L   : 0.3161515444388161
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 14
	train_loss     : 0.9848742792239555
	val_BLEU_1     : 0.4121593554166814
	val_BLEU_2     : 0.24403763345234153
	val_BLEU_3     : 0.15955959546834128
	val_BLEU_4     : 0.10775042343524242
	val_METEOR     : 0.17068407057647633
	val_ROUGE_L    : 0.3391101500080007
	test_BLEU_1    : 0.46844743520165655
	test_BLEU_2    : 0.29164751585784987
	test_BLEU_3    : 0.20130670717337157
	test_BLEU_4    : 0.14309965446126466
	test_METEOR    : 0.19401031039011646
	test_ROUGE_L   : 0.3656587368628067
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
Saving current best: model_best.pth ...
	epoch          : 15
	train_loss     : 0.9189183019674741
	val_BLEU_1     : 0.41139680938746354
	val_BLEU_2     : 0.2258938907372955
	val_BLEU_3     : 0.146144819278225
	val_BLEU_4     : 0.10189075990140775
	val_METEOR     : 0.15090989841445646
	val_ROUGE_L    : 0.3096870477127738
	test_BLEU_1    : 0.4315280065897636
	test_BLEU_2    : 0.25472984715883623
	test_BLEU_3    : 0.17879354186083293
	test_BLEU_4    : 0.13496900821409413
	test_METEOR    : 0.16989134593943428
	test_ROUGE_L   : 0.3360906488290886
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 16
	train_loss     : 0.8619930501167591
	val_BLEU_1     : 0.3420507827960529
	val_BLEU_2     : 0.20977071373730674
	val_BLEU_3     : 0.14548776406469624
	val_BLEU_4     : 0.10876327043150012
	val_METEOR     : 0.14439790460986882
	val_ROUGE_L    : 0.32522335179910733
	test_BLEU_1    : 0.35890367687073105
	test_BLEU_2    : 0.21898159563012448
	test_BLEU_3    : 0.15418839672615783
	test_BLEU_4    : 0.1157200813700061
	test_METEOR    : 0.14632520855298756
	test_ROUGE_L   : 0.3257825942451388
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
Saving current best: model_best.pth ...
	epoch          : 17
	train_loss     : 0.8011679346744831
	val_BLEU_1     : 0.25110967481565716
	val_BLEU_2     : 0.1467546731133364
	val_BLEU_3     : 0.10063736260742091
	val_BLEU_4     : 0.07484460782697586
	val_METEOR     : 0.11330294908122344
	val_ROUGE_L    : 0.29820560586241834
	test_BLEU_1    : 0.30088170962255856
	test_BLEU_2    : 0.18472342607637593
	test_BLEU_3    : 0.13100615661098175
	test_BLEU_4    : 0.0987593969211444
	test_METEOR    : 0.1326695160356431
	test_ROUGE_L   : 0.31949013202398274
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 18
	train_loss     : 0.7389737871976999
	val_BLEU_1     : 0.2494267065920246
	val_BLEU_2     : 0.1518144094956915
	val_BLEU_3     : 0.10587932361995006
	val_BLEU_4     : 0.0796220427466057
	val_METEOR     : 0.12145275238758908
	val_ROUGE_L    : 0.30802929005250923
	test_BLEU_1    : 0.2846641364794598
	test_BLEU_2    : 0.17889379436399763
	test_BLEU_3    : 0.1290000694281284
	test_BLEU_4    : 0.09939327865510802
	test_METEOR    : 0.13394705859923242
	test_ROUGE_L   : 0.32374830879922445
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 19
	train_loss     : 0.692358732682008
	val_BLEU_1     : 0.416072493770116
	val_BLEU_2     : 0.22737526303277683
	val_BLEU_3     : 0.14642937448588594
	val_BLEU_4     : 0.10145491747062711
	val_METEOR     : 0.15286253502675268
	val_ROUGE_L    : 0.30978629776466493
	test_BLEU_1    : 0.4284706119568289
	test_BLEU_2    : 0.2532441046301025
	test_BLEU_3    : 0.17739166420314662
	test_BLEU_4    : 0.13300707624571756
	test_METEOR    : 0.17224756697669347
	test_ROUGE_L   : 0.3373268361522524
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 20
	train_loss     : 0.642993862583087
	val_BLEU_1     : 0.3646246194726806
	val_BLEU_2     : 0.21446588258441723
	val_BLEU_3     : 0.1438273773297772
	val_BLEU_4     : 0.10313966211019558
	val_METEOR     : 0.14552385214536473
	val_ROUGE_L    : 0.315255146506044
	test_BLEU_1    : 0.3798733183440565
	test_BLEU_2    : 0.22851107783627894
	test_BLEU_3    : 0.15924235786924368
	test_BLEU_4    : 0.1180324230239361
	test_METEOR    : 0.15183295313596362
	test_ROUGE_L   : 0.3246383501605261
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 21
	train_loss     : 0.5917159674259332
	val_BLEU_1     : 0.330203912092162
	val_BLEU_2     : 0.19254083558138074
	val_BLEU_3     : 0.12716905374871043
	val_BLEU_4     : 0.09057716179275056
	val_METEOR     : 0.13167022058363081
	val_ROUGE_L    : 0.304739385957836
	test_BLEU_1    : 0.36495581624597667
	test_BLEU_2    : 0.22510511850469386
	test_BLEU_3    : 0.15934764814173047
	test_BLEU_4    : 0.12069688925377973
	test_METEOR    : 0.148699142610139
	test_ROUGE_L   : 0.32710124975407473
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 22
	train_loss     : 0.5521041725690549
	val_BLEU_1     : 0.2853996583613845
	val_BLEU_2     : 0.16873850326531167
	val_BLEU_3     : 0.1161282113111786
	val_BLEU_4     : 0.08641971840705635
	val_METEOR     : 0.11928345190588417
	val_ROUGE_L    : 0.2998648836051613
	test_BLEU_1    : 0.3213519545897632
	test_BLEU_2    : 0.1956339740233381
	test_BLEU_3    : 0.13795677836562842
	test_BLEU_4    : 0.10381095624085966
	test_METEOR    : 0.13417595618557274
	test_ROUGE_L   : 0.3168275842785777
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 23
	train_loss     : 0.5160540417982982
	val_BLEU_1     : 0.32697114549923045
	val_BLEU_2     : 0.19737775113428843
	val_BLEU_3     : 0.13459030463444385
	val_BLEU_4     : 0.09730593683689191
	val_METEOR     : 0.13448205489240658
	val_ROUGE_L    : 0.3089572004171719
	test_BLEU_1    : 0.3324342338091717
	test_BLEU_2    : 0.206624627054673
	test_BLEU_3    : 0.147573667329279
	test_BLEU_4    : 0.11194638461128008
	test_METEOR    : 0.14006649558381476
	test_ROUGE_L   : 0.32465251516381566
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 24
	train_loss     : 0.47836592678840345
	val_BLEU_1     : 0.4347336045532299
	val_BLEU_2     : 0.2576887747853258
	val_BLEU_3     : 0.17160527554126676
	val_BLEU_4     : 0.12290198318670137
	val_METEOR     : 0.16540189505573022
	val_ROUGE_L    : 0.32195304494316007
	test_BLEU_1    : 0.4386660566315673
	test_BLEU_2    : 0.2698727509082001
	test_BLEU_3    : 0.19067340129859112
	test_BLEU_4    : 0.14453706818631307
	test_METEOR    : 0.17950780823167947
	test_ROUGE_L   : 0.3461736924435621
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
Saving current best: model_best.pth ...
	epoch          : 25
	train_loss     : 0.4558902983482067
	val_BLEU_1     : 0.2748803376195208
	val_BLEU_2     : 0.1657668579656095
	val_BLEU_3     : 0.11529584139025219
	val_BLEU_4     : 0.08619744887588529
	val_METEOR     : 0.12078179140759925
	val_ROUGE_L    : 0.3053944593020246
	test_BLEU_1    : 0.316030832927565
	test_BLEU_2    : 0.19545256617468046
	test_BLEU_3    : 0.14004835883446684
	test_BLEU_4    : 0.10688496974292049
	test_METEOR    : 0.1362028863341898
	test_ROUGE_L   : 0.32134042532641394
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 26
	train_loss     : 0.42321710815796487
	val_BLEU_1     : 0.4203332203593122
	val_BLEU_2     : 0.2522639323887465
	val_BLEU_3     : 0.17056172272364836
	val_BLEU_4     : 0.12368348320105604
	val_METEOR     : 0.16307278333429603
	val_ROUGE_L    : 0.32974078516238126
	test_BLEU_1    : 0.44300583614159667
	test_BLEU_2    : 0.2695938991308951
	test_BLEU_3    : 0.18853724691886217
	test_BLEU_4    : 0.14101131041055578
	test_METEOR    : 0.17414421832725216
	test_ROUGE_L   : 0.34267847795694756
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
Saving current best: model_best.pth ...
	epoch          : 27
	train_loss     : 0.3969830776636417
	val_BLEU_1     : 0.38627175320562557
	val_BLEU_2     : 0.230690033742717
	val_BLEU_3     : 0.1566399229206618
	val_BLEU_4     : 0.11456420264551058
	val_METEOR     : 0.15117531964872055
	val_ROUGE_L    : 0.3162156724560091
	test_BLEU_1    : 0.4101218232166162
	test_BLEU_2    : 0.2554417254294083
	test_BLEU_3    : 0.18106663163973216
	test_BLEU_4    : 0.13706919973003817
	test_METEOR    : 0.1624163927741059
	test_ROUGE_L   : 0.3359174997400282
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 28
	train_loss     : 0.37523467678290146
	val_BLEU_1     : 0.3016248013330839
	val_BLEU_2     : 0.18550816084152907
	val_BLEU_3     : 0.12975873830093745
	val_BLEU_4     : 0.09689532817998547
	val_METEOR     : 0.13379259683006306
	val_ROUGE_L    : 0.311841789472541
	test_BLEU_1    : 0.3289173813114407
	test_BLEU_2    : 0.20368714002199134
	test_BLEU_3    : 0.14284369847931194
	test_BLEU_4    : 0.10549782267388752
	test_METEOR    : 0.14411673424695695
	test_ROUGE_L   : 0.3225315231504343
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 29
	train_loss     : 0.3570327362188926
	val_BLEU_1     : 0.40703115096747555
	val_BLEU_2     : 0.23149206351382534
	val_BLEU_3     : 0.14863797833420472
	val_BLEU_4     : 0.10158168853874677
	val_METEOR     : 0.15284507513351595
	val_ROUGE_L    : 0.30977081286359487
	test_BLEU_1    : 0.43235761521502886
	test_BLEU_2    : 0.25966082488656655
	test_BLEU_3    : 0.18040619938608857
	test_BLEU_4    : 0.13406981370495788
	test_METEOR    : 0.173407293457133
	test_ROUGE_L   : 0.3405733617570082
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
	epoch          : 30
	train_loss     : 0.34121550619602203
	val_BLEU_1     : 0.4173693836247522
	val_BLEU_2     : 0.2554323316488516
	val_BLEU_3     : 0.1722294915943729
	val_BLEU_4     : 0.1234341028635255
	val_METEOR     : 0.16180438463959557
	val_ROUGE_L    : 0.32389614633469055
	test_BLEU_1    : 0.447146791148939
	test_BLEU_2    : 0.28277689421448676
	test_BLEU_3    : 0.19855499383183897
	test_BLEU_4    : 0.1464356393879192
	test_METEOR    : 0.17593037500569528
	test_ROUGE_L   : 0.34068695119414744
Saving checkpoint: results/iu_xray_debug/current_checkpoint.pth ...
slurmstepd: error: *** JOB 17044629 ON dgx004 CANCELLED AT 2020-12-23T11:33:36 ***
